{% extends 'base.html' %}
{% load static %}
{% csrf_token %}

{% block content %}
	<!-- INTRO - BEFORE QUIZ - inProgress = false-->
	<div class="quiz-div" ng-show="!inProgress">
		<div class="row">
			<div class="col-md-8 col-md-offset-2">
			<h1 class="text-center">Test how well you know your favorite Parks and Rec characters!</h1>
			</div>
		</div>
		<br><br><br><br><br>
		<button id="start-button" class="btn btn-success btn-lg center-block" ng-click="start()">START THE QUIZ</button>
<!--  			<button id="start-button" class="btn btn-success btn-lg center-block" ng-click="testing()">TESTING</button>
-->	
		<div class="leaders-link">
			<a href="/leaders"><h4>See the leaderboard</h4></a>
		</div>
	</div>

	<!-- POST INTRO - inProgress = true -->
	<div class="quizzing" ng-show="inProgress">
		<div id="score">
			<h3 class="text-center">Your Score: [[score]]/10</h3>
		</div>
		<!-- ACTUAL QUIZ - quizOver = false-->
		<div ng-show="!quizOver">
			<div class="question-text">
				<h2 id="specific-question" class="text-center">[[id + 1]]. "[[question]]"</h2>
			</div>

			<div ng-show="answerMode">
				<div class="response-field">
					<div angucomplete-alt placeholder="Type or select from dropdown" id="search-field" selected-object="answerSelect" title-field="person" local-data="array_people" search-fields="person" minlength="0" match-class="highlight" image-field="pic"/>
					</div>
				</div>
			</div>

			<div ng-show="!answerMode" class="centering-icons">
				<div ng-show="correctAnswer">
						<button id="next-question-button-correct" class="btn btn-success btn-lg center-block" ng-click="nextQuestion()">
						Correct!
						</button>
				</div>
				<div ng-show="!correctAnswer">
					<button id="next-question-button-incorrect" class="btn btn-danger btn-lg center-block" ng-click="nextQuestion()">
					Incorrect!
					</button>
				</div>
			</div>
		</div>
		<!-- QUIZ IS COMPLETE - quizOver = true-->
		<div ng-show="quizOver">
			<div class="leaders-board">
				<div id="user-submit-form">
					<div ng-show="!submitName">
						<form name="userForm" class="form-inline">
							{% csrf_token %}
							<fieldset class="form-group">
								<h5>Submit your name and score to see if you made it into the leaderboard</h5>
								<input class="form-control" placeholder="First Last" ng-model="userName" required name="userName" ng-minlength="3" ng-maxlength="25">
								<button type="submit" class="btn btn-primary" ng-click="submitScore(userName)" ng-disabled="userForm.userName.$error.required || userForm.userName.$error.minlength || userForm.userName.$error.maxlength">Submit Name</button>
							</fieldset>
							<p ng-show="userForm.userName.$error.required || userForm.userName.$error.minlength || userForm.userName.$error.maxlength" class="help-block">Name must be between 3 and 25 characters long</p>
						</form>
					</div>
				</div>
				<div id="leader-table-div" ng-show="submitName">
					<div id="table-header">
						<h3>Quiz Leaders</h3>
					</div>
					<table class="table table-striped" id="leader-table">
						<thead>
							<tr>
								<th>Name</th>
								<th>Score</th>
						  	</tr>
						</thead>

						<tbody id="user-scores">
						</tbody>
					</table>
				</div>
			</div>
			<div class="quiz-summary">
				<h3>Summary of Results:</h3>
				<br>
				<ol class="questions-list" ng-repeat="item in jsonSummary">
					<blockquote>
						<p>[[$index + 1]]. "[[item.question]]" </p>
						<footer class="footer-size">
							<span style="color:green" ng-if="item.usAnswer == item.corrAnswer">
								[[item.corrAnswer]]
							</span>
							<span ng-if="item.usAnswer != item.corrAnswer">
								<span style="color:red">
									<s>[[item.usAnswer]]</s>
									<span style="color:green">
										[[item.corrAnswer]]
									</span>
								</span>
							</span>
						</footer>
					</blockquote>
				</ol>
			</div>
			<div class="restart-share">
				<span class="restart-button-padding">
					<button id="restart-button" class="btn btn-primary btn-lg center-block" ng-click="reset()">Take the Quiz Again!</button>
				</span>
				<br>
			<button id="facebook-button" class="btn btn-primary center-block" ng-click="postFacebook()"><img src="{% static 'img/facebook_logo.png' %}">Share your results on Facebook!</button>
			</div>

			<div class="add-quotes">
			<h3>Didn't see your favorite Parks and Rec quote? Add it yourself!</h3>
				<div ng-show="!addQuotes">
					<br>
					<form name="form" class="form padding-left-50 padding-down">
						<div class="form-group">
							<h4>Person</h4>
 							<select class="form-control" ng-model="userPerson" ng-init="userPerson = userPerson" ng-options="person.person as person.person for person in array_people">
 							</select>
						</div>

						<div class="form-group">
							<h4>Quote</h4>
							<textarea class="form-control" id="user-text-area" required name="userQuoteInput" ng-minlength="4" ng-model="userQuote" placeholder="Insert quote here. No need to enclose with quotation marks." /></textarea>
							<label>[[ 160 - form.userQuoteInput.$viewValue.length ]]</label>
							<p ng-show="(form.userQuoteInput.$error.required || form.userQuoteInput.$error.minlength || userQuote.length > 160) && form.userQuoteInput.$dirty" class="help-block">Quote must be between 4 and 160 characters</p>
						</div>
						<button class="btn btn-primary" ng-disabled="form.userQuoteInput.$error.required || form.userQuoteInput.$error.minlength || userQuote.length > 160" ng-click="userAdd()">Submit Quote</button>
					</form>
				</div>
				<div ng-show="addQuotes" class="form thank-you-submission padding-down">
				<br>
				<span style="color:green">
					<i class="glyphicon glyphicon-check"></i>
					<label>Quote was successfully submitted! Thanks!</label>
				</span>
				<br><br><br><br><br>
				</div>
			</div>
		</div>
	</div>
{% endblock %}