{% extends 'base.html' %}
{% load static %}
{% csrf_token %}

{% block content %}
    <script>
      window.fbAsyncInit = function() {
        FB.init({
          appId      : '359686774227548',
          xfbml      : true,
          status	 : true,
          version    : 'v2.3'
        });
      };

      (function(d, s, id){
         var js, fjs = d.getElementsByTagName(s)[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement(s); js.id = id;
         js.src = "//connect.facebook.net/en_US/sdk.js";
         fjs.parentNode.insertBefore(js, fjs);
       }(document, 'script', 'facebook-jssdk'));
    </script>

	<div class="container">

		<div class="header">
			<img id="logo" src="{% static 'img/parks_and_rec_logo.png' %}" class="center-block">
		</div>


		<!-- INTRO - BEFORE QUIZ - inProgress = false-->
		<div class="quiz-div" ng-show="!inProgress">
			<div class="row">
				<div class="col-md-8 col-md-offset-2">
				<h1 class="text-center">Test how well you know your favorite Parks and Rec characters!</h1>
				</div>
			</div>
			<br><br><br><br><br>
			<button id="start-button" class="btn btn-success btn-lg center-block" ng-click="start()">START THE QUIZ</button>
<!-- 			<button id="start-button" class="btn btn-success btn-lg center-block" ng-click="testing()">TESTING</button>
 -->		</div>

		<!-- POST INTRO - inProgress = true-->
		<div class="quizzing" ng-show="inProgress">
			<div id="score">
				<h3 class="text-center">Your Score: [[score]]/10</h3>
			</div>
			<!-- ACTUAL QUIZ - quizOver = false-->
			<div ng-show="!quizOver">
				<div class="question-text">
					<h2 id="specific-question" class="text-center">[[id + 1]]. "[[question]]"</h2>
				</div>

				<div ng-show="answerMode">
					<div class="response-field">
						<div angucomplete-alt id="search-field" selected-object="answerSelect" title-field="person" local-data="array_people" search-fields="person" minlength="1" match-class="highlight" />
						</div>
					</div>
				</div>

				<div ng-show="!answerMode" class="centering-icons">
					<div ng-show="correctAnswer">
							<button id="next-question-button-correct" class="btn btn-success btn-lg center-block" ng-click="nextQuestion()">
							Correct!
							</button>
					</div>
					<div ng-show="!correctAnswer">
						<button id="next-question-button-incorrect" class="btn btn-danger btn-lg center-block" ng-click="nextQuestion()">
						Incorrect!
						</button>
					</div>
				</div>
			</div>
			<!-- QUIZ IS COMPLETE - quizOver = true-->
			<div ng-show="quizOver">
				<div class="quiz-summary">
					<h3>Summary of Results:</h3>
					<br>
					<ol class="questions-list" ng-repeat="item in jsonSummary">
						<blockquote>
							<p>[[$index + 1]]. "[[item.question]]" </p>
							<footer class="footer-size">
								<span style="color:green" ng-if="item.usAnswer == item.corrAnswer">
									[[item.corrAnswer]]
								</span>
								<span ng-if="item.usAnswer != item.corrAnswer">
									<span style="color:red">
										<s>[[item.usAnswer]]</s>
										<span style="color:green">
											[[item.corrAnswer]]
										</span>
									</span>
								</span>
							</footer>
						</blockquote>
					</ol>
				</div>
				<div class="restart-share">
					<span class="restart-button-padding">
						<button id="restart-button" class="btn btn-primary btn-lg center-block" ng-click="reset()">Take the Quiz Again!</button>
					</span>
					<br>
				<button id="facebook-button" class="btn btn-primary center-block" ng-click="postFacebook()"><img src="{% static 'img/facebook_logo.png' %}">Share your results on Facebook!</button>
				</div>

				<div class="add-quotes">
				<h3>Didn't see your favorite Parks and Rec quote? Add it yourself!</h3>
					<div ng-show="!addQuotes">
						<br>
						<form name="form" class="form padding-left-50 padding-down">
							<div class="form-group">
								<h4>Person</h4>
	 							<select class="form-control" ng-model="userPerson" ng-init="userPerson = userPerson" ng-options="person.person as person.person for person in array_people">
	 							</select>
							</div>

							<div class="form-group">
								<h4>Quote</h4>
								<textarea class="form-control" id="user-text-area" required name="userQuoteInput" ng-minlength="4" ng-model="userQuote" placeholder="Insert quote here. No need to enclose with quotation marks." /></textarea>
								<label>[[ 160 - form.userQuoteInput.$viewValue.length ]]</label>
								<p ng-show="(form.userQuoteInput.$error.required || form.userQuoteInput.$error.minlength || userQuote.length > 160) && form.userQuoteInput.$dirty" class="help-block">Quote must be between 4 and 160 characters</p>
							</div>
							<button class="btn btn-primary" ng-disabled="form.userQuoteInput.$error.required || form.userQuoteInput.$error.minlength || userQuote.length > 160" ng-click="userAdd()">Submit Quote</button>
						</form>
					</div>
					<div ng-show="addQuotes" class="form thank-you-submission padding-down">
					<br>
					<span style="color:green">
						<i class="glyphicon glyphicon-check"></i>
						<label>Quote was successfully submitted! Thanks!</label>
					</span>
					<br><br><br><br><br>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}